
Publishing:
  pnpm changeset publish --no-git-tag
  Angular beta repro:
  https://stackblitz.com/edit/github-sphfu1?file=package.json,src%2Findex.html


ASAP
----

breaking: viewClass* hooks receives single View argument, NOT { view }
todo: move bottom-borders to cells!
  - [done] datagrid
  - timeline resource lanes
  - timeline slats
  - timegrid slats
bug: scroll to bottom of resource-timegrid-hscroll.html, scrollers out of sync
tests: for all places isMajor emitted
breaking: column hooks, instead of groupValue/text, uses fieldValue
breaking: resourceAreaHeaderClassNames apply to normal col-headers now too
todo: calendar-wide resourceColumnHeader* hooks don't receive column definition
bug: expander icon indent is wrong -- resource-timeline-row-grouping.html
breaking: dayLane* separated from dayCell*
spec-out: how did we decide a theme would determine if daygrid-week-view/etc
  would have day-numbers in the cell? dayCellAboveClassNames?
if colorSchemed set to 'dark', but on a light page,
  the css prop of some root ancestor should be color-scheme:dark (see ag-grid's scrollbars)
fix createViewHookComponent HACKS
  we're giving crap values to ppl who rely on custom view rendering
  viewApi is in context. use it!
slotLaneContent/slotLaneInnerClassNames -- what's the point? remove? needs cell-inner padding?
why do we need fc-list-day-outer?
changelog: dayCellContent (now called dayCellTopContent) no longer injected into daypopover
changelog: dayCellClassNames/DidMount/WillUnmount no longer called on daypopover
todo: normalize hooks that accept `text` (not `dayNumberText`)

package.json for classic-theme
importmap.public.html needs to be updated. accesses published files

Sticky header dates look terrible in timegrid/daygrid
Look for emphasizeWeeks/fc-timeline-slot-em ... should become ({ isMajor })
Should we still have data-date attributes on elements?

css:
  .fc-navlink -> .fc-nav-link
  .fc-celldivider -> .fc-cell-divider
  .fc-rowdivider -> .fc-row-divider
  .fc-fill-start -> .fc-fill-s
  .fc-fill-top -> .fc-fill-t
  .fc-fill-x -> .fc-fill-h
  .fc-fill-y -> .fc-fill-v
  unused .fc-offscreen

don't use <Scroller> when not necessary
  ListView
  MultiMonth

ResizeObserver problems
  ResourceTimeline height:auto
    premium/bundle/a11y-ci/resource-timeline-flat-height-auto.html
    Not exactly sure why fixed-scrollbar would cause this
    Comment-out all Scroller vertical watching,
      then toggle time-area footer fixed-scrollbar. toggles problem
  ResourceTimeline switching resourceTimelineDay -> resourceTimelineThreeDays
    premium/bundle/a11y-ci/resource-timeline-flat-height.html
    Happening when timeline-header height increases,
      needs to change height of data-grid header, thus data-grid body
  AFTER:
    HACK in tests with Calendar::updateSize calls in callback, ULTIMATELY UNDO THOSE
    Check https://codesandbox.io/p/sandbox/3vxvhg?file=%2Fsrc%2FApp.js

css:
  move cell border to flex-end
    better for infinite horiztonal scroll later
    rows have it on bottom because better for print, breaking to second page
  do .fci prefix
  try to flatten all selectors
  rethink unbolding heading cells
  TimeGrid cols should be below slats:
    https://fullcalendar.freshdesk.com/a/tickets/9203
    Same with DayGrid, putting background-events underneath lines?
    we don't want to force people to do semi-transparent colors
  expose an equiv for fc-timegrid-event-harness-inset, to adjust padding
  .fc-week-number?
  .fc-timegrid-weeknumber -> .fc-timegrid-week-number (to match with .fc-daygrid-week-number)
  .fc-table-header renamed?
  .fc-timegrid-slots needed?
  .fc-timegrid-slots-axis needed?
  .fc-timeline-slots needed?
  Change???
    .fc-timegrid-allday-label-inner -> .fc-timegrid-allday-label .fc-cell-inner
    .fc-timegrid-axis-inner         -> .fc-timegrid-axis .fc-cell-inner
  use .fc-cell everywhere? .fc-row too? what's the objective?
    update to include list-view, which uses th/td as well
      put .fc-header-cell on days?
      have left-to-right items be .fc-cell-inner?

docs & site:
  talk about updateSize doesn't needed because of ResizeObserver
  Create aXe scrollbar workaround
  Create new issues for various things, update total
  write cookbook on common css customizations. .fc prefix not needed
  Update roadmap

Upgrade Guide
-------------

Note that scrollgrid will be removed in v7
Accept falsy className inputs. will remove

Release Prep
------------

New linting system
Ensure `private` on all private class members
Ensure built types don't leak internal structures
Tame all scratch example files
Remove outdated .changeset transactions
Ensure outputted CSS doesn't have multiple :root declarations because of how we shifted vars.css around
Revert "hacks to get print-mode working, but some should be reverted"
Revert temporary gitignores
Audit all dependency workspace: protocols

Automated Test TODO
-------------------

how an event can render as a/div/div[role=button]
weird list-view slicing logic we removed
  https://github.com/fullcalendar/fullcalendar/blob/9a0edaeb5eddf2cec8bd2409ecc26c4598b98a48/packages/list/src/ListView.tsx#L235-L249
resource-timeline rowgrouping
  has correct borders on bottom of rows, even when all row groups collapsed
  when expandRows: true, groups do not expand, only resources!
timeline/hscroll-timeGRID, when sticky-header
  ensure time-axis or resource area has bottom filler to match horizontal scrollbar
resource-timeline group cells (that run vertically) have correct border, especially 2nd and 3rd down
positioning of sticky headers in all views. list view sticky subheaders too
resource-timeline indent works
pixel # for height/contentHeight works
correct header row heights for multi-header resource-TIMEgrid row with horizontal scrolling
when nowIndicator is OFF, doesn't render in DOM at all
percentage-based resource-timeline spreadsheet-column resizing
that expandRows works enabled/disabled for timegrid/resource-timeline views
test datagrid with h scroll, but timeline area WITHOUT h scroll
multiple tiers of headers line-up across scrollers
  timegrid h-scroll. with and without weekNumber
  resource-timeline. w/ datagrid/timeline headers: 1/2, 2/1
disabled days
  do NOT render navlinks (header or obviously day number)
  the headers WILL render data-date, fc-day-disabled (but not dayofweek, past, future classNames)
audit all past a11y bugs that aren't picked up by audit tool
  such as https://github.com/fullcalendar/fullcalendar/issues/7566
  "The div and span elements have an implicit role of generic and cannot be named unless they have a role attribute."
aria-current='date' on today
no empty header cells
  https://github.com/fullcalendar/fullcalendar/issues/2536#issuecomment-703825166
[v7-beta] Day cells do not expand to fit events in dayGridYear
  https://github.com/fullcalendar/fullcalendar/issues/7852
[resource-timeline] timeline-lane-footer has padding when eventOverlap:true, no padding when false
[timeline-no-resources] always has timeline-lane-footer, especially for when zero events and height:auto
timeline-event-rendering.ts, disabled test because flawed
  about zoom and event aligning w/ start and end
Perf: not rerendinering events that didn't change
  https://github.com/fullcalendar/fullcalendar/issues/3003
TimeGrid scrollTime:0 initially scrolls to 0 (a solved regression)
Tests for auto-scroll (not necessarily v7)

Freshdesk/GH-issues
-------------------

Fixed this issue of mousedown taking long time to recalculate style?
  https://fullcalendar.freshdesk.com/a/tickets/9078
  Can see forced-reflow warning here too: bundle/examples-v7/issue-7677.html
Make tickets for a new view with list-view underneath month calendar
Check ticket for daygrid view with "dots"
Need to split this issue
  https://github.com/fullcalendar/fullcalendar/issues/1037
  1. scrollreset (already implemented)
  2. scroll to current date or time
when infinite scroll-loading done
  https://fullcalendar.freshdesk.com/a/tickets/9668
when virtual rendering done
  https://fullcalendar.freshdesk.com/a/tickets/8496
  https://fullcalendar.freshdesk.com/a/tickets/9701
make ticket where +more popover is responsive? (takes up whole phone screen)
file bug for strange dragging events from timeline more-link (preexists)
timeline event dragging loses duration:
  1. have +more link with eventMaxStack
  2. open link, begin to drag event
  3. event looses it's duration. inconsistent with how normal event dragging happens
  (will be breaking change? maybe file ticket and add changelog)
  PREEXISTS: https://codepen.io/arshaw/pen/jOgeGwm?editors=0010
file preexisting v6 bug:
  non-singular view duration unit has weird hints on buttons "This ", "Next ", "Previous "
  https://codepen.io/arshaw/pen/yyBpopg?editors=0010
TimeGrid
  Known visual regression with event positioning
    After implementing restored v4 timegrid event spacing (https://github.com/fullcalendar/fullcalendar/issues/6569),
    Events squish too much:
      v4: https://codepen.io/arshaw/pen/pvzLNKr?editors=001 (BAD)
      v5: https://codepen.io/arshaw/pen/YPKapao?editors=0010 (GOOD)
      v6: https://codepen.io/arshaw/pen/NPKYbYb?editors=0010 (GOOD)
      v7: https://codepen.io/arshaw/pen/wBwJmgg?editors=001 (BAD)

Punt
----

General Markup
  in future css className refactor:
    fc-dayGridMonth -> fc-daygridmonth (to match fc-daygrid)
    fc-dayGridMonth-button -> fc-daygridmonth-button
    fc-timeline-now-indicator-arrow -> fc-timeline-nowindicator-arrow
    fc-timeline-more-link -> fc-timeline-morelink
    NEVERMIND. we've developed a strong precedent of dash-breaking-words,
      like week-number/day-number which needs to be both subcomponent (fc-daygrid-day>fc-daygrid-day-number)
      and independent component (fc-daygrid-week-number)
  Drop-shadow under sticky header, timeline headers
General Responsive
  Hide event times (daygrid/timeline) if too small?
  should fc-padding-* classes be responsive, meaning related to font-size?
    for fc-daygrid-day-number/fc-daygrid-week-number too
General Performance
  use css translateX/Y instead of top/left to prevent reflows
  user IntersectionObserver for DnD?
  when there's no ref watching a dimension, don't attach resize observer to element
    example: simple Month-view always listens to header heights (innerHeightRef) because TimeGrid
    needs to sync height with all-day cell
  TEST AFTER RELEASE - dayClick slow
    https://github.com/fullcalendar/fullcalendar/issues/6199 (dateClick)
    V6 repro: https://codepen.io/arshaw/pen/OJKMLRR?editors=0010
    V7 has no real improvement
General a11y
  Week numbers should be tabbable
  have separate settings for date-format hints? out of whack
    view's aria-label (if no headerToolbar) is "Sep 7 – 8, 2020" (bad that it's abbreviated)
    week-view's column headers have hint "September 7, 2020" which don't include day of week (like real text "Mon 9/7")
  change <button> to role=button for fewer css reset collision?
  "Note: The aria-rowindex must be added to each row, but is optional on the cells, except for cells that span rows: the aria-rowindex attribute is required on all spanning cells."
    https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-rowindex
DayGrid
  prevent DayGridCell headers from overflowing? makes really small calendars look better
  [structure] simplify event positioning
    normalize each event-container's top by applying margin-top on ones that have smaller headers
    position each event-harness with a margin-top (in combo with existing abs positioning)
    after this^, we'll know the explicit min-height a row should be
      TODO: use this to explicitly set min-height on row div, this will override the not-smart
      "default" that the browser decides. then, force min-height:0 for all flex items (same with min-width),
      to be more like react-native, and more intuitive
Resource Timeline
  [structure] when no groupcols, do simplified DOM structure?
  get grouping via row and col simultaneously working. should be possible.
    see timeline-row-n-col-grouping-not-working.html
Angular
  Building example project gives warnings like
    Ignoring this import because ".." was marked as having no side effects
TimeGrid
  when date-selecting with mirror event, why are we rendering highlight?
  for timeline event-dnd, the mirror, should have white glow just like timegrid for when overlap other events
    https://codepen.io/arshaw/pen/jOgeGwm?editors=0010
Timeline
  for timeline event-dnd, the mirror, should have white glow just like timegrid for when overlap other events
MultiMonth
  put navlink on multimonth month header text?
  For print, force +morelink to isCompact=true
    Starting out NOT compact in forced 2-col formation, but when gets squished to where isCompact
    is needed, but ResizeObserver/etc doesn't adapt. examples-v7/multimonth-view.html
Cross-browser
  Firefox
    [bug][regression]: after print-view (for timegrid as least) scroll gutter filler permanently disappears
      does not happen when rigging up "P" keystroke
    Re-address borderBoxSize HACK
    resource-timeline header borders a little messed up
  Chrome
    [bug] with timeline sticky multi-tier date text
      premium/bundle/examples/timeline-sticky-header.html
      1. Click 3-day view
      2. Resize resource area
      3. "Sat 1/7" flickers and changes position
Example Projects
  In each two-column layout, give the sidebar flex-shrink:0 and the main min-width:0
    Things are currently collapsing very strangely on a narrow screen (like stackblitz angular demo)

Notes
-----

we really do care about minimizing ResizeObserver loops, prevents flicker. so, safari is valuable
flexbox row expansion works across scroll regions: https://codepen.io/arshaw/pen/rNXdrLm?editors=1100
100% width within scroller applies to clientWidth only: https://codepen.io/arshaw/pen/GgKWRNZ?editors=1100
Print
  if you hit the debugging 'p' to force print-mode too soon after you stop scrolling,
    scrollEnd won't have enough time to fire and scroll state likely won't be saved,
    resulting in jump when entering print-mode. however, this isn't a realistic scenario because
    usually users have a long time between when they stop scrolling and when they initiate printing
  translateX/Y doesn't work when sticky items inside
  siblings must all be absolutely positioned if they are supposed to overlap
    and if you want them to span to subsequent pages in-sync
  Firefox:
    sometimes you just need to restart Firefox and things start working :(
    setting a bottom coordinate will NEVER wrap to subsequent pages
      problems with height:100% as well. hardcoded height needed
    weird issue: if abs positioned element starts on 2nd page and spans to third,
      makes a strange gap on 3rd page and pushes all content afterwards down
    if there's any sort of overflow:hidden/scroll container,
      screws up absolute positioning within, when spanning to subsequent pages. must disable
    JUST GIVE UP on multi-page absolutely positioned items in firefox
  bugzilla flexbox issues
    master ticket (pending): https://bugzilla.mozilla.org/show_bug.cgi?id=939897
    special-case fix (done): https://bugzilla.mozilla.org/show_bug.cgi?id=939897
      supposedly milestone 78.0a1
  bug with flexbox AND absolute positioning wrapping to subsequent pages (our discovery)
    ("Dinner" isn't showing up; starts on second page)
    (NEED TO LOOK AT ACTUAL PDF - differs from print preview sometimes)
      Firefox 120 - perfect
      Firefox 110 - good (event y off by 1px)
      Firefox 100 - good (event y off by 1px)
      Firefox 97 - good (event y off by 1px) --- February 8, 2022
      Firefox 96 - bad
      Firefox 95 - bad
      Firefox 90 - bad
  known-bugs:
    On Safari, table headers are not repeated for any view (browser bug)
a11y tree considerations
  aria-controls on resource-timeline parent-toggler
    is difficult because a parent row could control MANY child rows, and we don't have wrappers for
    those children, so aria-controls would need to be a huge dynamic list of tokens
  additional aria
    aria-level (depth)
    aria-posinset (index in current set)
    aria-setsize (current set size, not child size)
    ***I wanted to do this, but if rows out of order (because of virtualization),
      then no way to establish parent/child relationships
Why we need to use a <Ruler> to measure dimensions
  ResizeObserver does NOT synchronously handle dimension changes to self or ancestors while
  handling current element's dimensions. Will give a "ResizeObserver loop completed with undelivered notifications"
  error. Quintessential example is implementing an aspect-ratio element, which sets height of self after reading
  width of self. <Ruler> detangles dimension relationships and is very portable.
"invalid" dates aka "disabled" dates
  DayGridMONTH: https://codepen.io/arshaw/pen/EaYXWPM?editors=0010
    normal weekday header
    empty cells
  DayGridWEEK: https://codepen.io/arshaw/pen/mybwWEE?editors=0010
    empty header --> change to rendered headers!
    empty cells
  TimeGrid: https://codepen.io/arshaw/pen/pvzweyV?editors=001
    empty header --> change to rendered headers!
    empty cells
  Timeline: https://codepen.io/arshaw/pen/WbeOpwX?editors=0010 (must scroll left after load)
    normal header
    empty cell
How to do liquid-width/height, multiple technique
  Classic performant technique (currently used):
    FIXED-AREAS: nothing
    LIQUID-AREAS: { flex-grow:1, min-height:0, flex-basis:0 }
    Needed for horizontal equal-width cell expansion; basis0 is important
  Experimental:
    FIXED-AREAS: { flex-shrink:0 }
    LIQUID-AREAS: { flex-grow:1, min-height:0 }
    Good for layouts that are conditionally liquid-height
    Tho probably not as performant because need to compute the pre-squished AND post-squished layouts
